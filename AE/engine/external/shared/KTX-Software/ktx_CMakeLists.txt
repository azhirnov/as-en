cmake_minimum_required( VERSION 3.10 FATAL_ERROR )

project( "KTX-main" LANGUAGES CXX )

include( "../../../config.cmake" )

# SIMD
if (${AE_SIMD_AVX} GREATER 0)
    set( ASTCENC_ISA_SSE41  ON  CACHE BOOL "" FORCE )
    set( BASISU_SUPPORT_SSE ON  CACHE BOOL "" FORCE )

elseif (${AE_SIMD_SSE} GREATER_EQUAL 41)
    set( ASTCENC_ISA_SSE41  ON  CACHE BOOL "" FORCE )
    set( BASISU_SUPPORT_SSE ON  CACHE BOOL "" FORCE )

elseif (${AE_SIMD_SSE} GREATER_EQUAL 20)
    set( ASTCENC_ISA_SSE41  OFF CACHE BOOL "" FORCE )
    set( ASTCENC_ISA_SSE2   ON  CACHE BOOL "" FORCE )
    set( BASISU_SUPPORT_SSE ON  CACHE BOOL "" FORCE )

else()
    set( ASTCENC_ISA_SSE41  OFF CACHE BOOL "" FORCE )
    set( ASTCENC_ISA_SSE2   OFF CACHE BOOL "" FORCE )
    set( ASTCENC_ISA_NEON   OFF CACHE BOOL "" FORCE )   # TODO: Mac/iOS ARM
    set( ASTCENC_ISA_NONE   ON  CACHE BOOL "" FORCE )
    set( BASISU_SUPPORT_SSE OFF CACHE BOOL "" FORCE )
endif()

set( KTX_FEATURE_DOC            OFF CACHE BOOL "" FORCE )
set( KTX_FEATURE_GL_UPLOAD      OFF CACHE BOOL "" FORCE )
set( KTX_FEATURE_JNI            OFF CACHE BOOL "" FORCE )
set( KTX_FEATURE_KTX1           ON  CACHE BOOL "" FORCE )
set( KTX_FEATURE_KTX2           ON  CACHE BOOL "" FORCE )
set( KTX_FEATURE_STATIC_LIBRARY ON  CACHE BOOL "" FORCE )
set( KTX_FEATURE_TESTS          OFF CACHE BOOL "" FORCE )
set( KTX_FEATURE_TOOLS          ON  CACHE BOOL "" FORCE )
set( KTX_FEATURE_VK_UPLOAD      OFF CACHE BOOL "" FORCE )

include( "origin_CMakeLists.txt" )
